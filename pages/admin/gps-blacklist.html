<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>TechLoc • GPS Blacklist Admin</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet" />
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/lucide@latest"></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script type="module" src="../../assets/js/supabaseClient.js"></script>
  <script type="module" src="../../assets/scripts/admin-auth.js"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: { sans: ['Inter', 'system-ui', 'sans-serif'] },
          colors: { slate: { 950: '#020617' } },
        },
      },
    };
  </script>
  <link rel="stylesheet" href="../../assets/visuals/theme.css" />
</head>
<body class="min-h-screen bg-slate-950 text-slate-50" data-page-title="GPS Blacklist" data-active-nav="dashboard">
  <div data-auth-loading class="fixed inset-0 z-50 flex items-center justify-center bg-slate-950">
    <div class="flex items-center gap-3 rounded-2xl border border-slate-800 bg-slate-900 px-5 py-3 shadow-xl shadow-slate-900/60">
      <span class="h-3 w-3 animate-pulse rounded-full bg-blue-400"></span>
      <p class="text-sm font-semibold text-slate-200">Validating secure session…</p>
    </div>
  </div>

  <div data-auth-protected class="hidden">
    <div class="sticky top-0 z-50 space-y-px">
      <div data-shared-header></div>
      <div data-admin-nav data-admin-nav="gps-blacklist"></div>
    </div>

    <canvas id="constellation-canvas" class="pointer-events-none fixed inset-0 -z-10"></canvas>

    <main class="mx-auto w-full max-w-7xl space-y-6 px-6 py-8 lg:px-10">
      <section class="rounded-3xl border border-slate-800 bg-slate-900/70 p-6 shadow-xl shadow-blue-900/20">
        <div class="flex flex-col gap-4 lg:flex-row lg:items-end lg:justify-between">
          <div>
            <p class="text-xs font-semibold uppercase tracking-[0.2em] text-blue-200">Admin only</p>
            <h1 class="text-3xl font-black text-white">GPS Blacklist</h1>
            <p class="mt-2 text-sm text-slate-300">Manage the <span class="font-semibold text-blue-200">gps_blacklist</span> table.</p>
          </div>
          <div class="flex flex-wrap items-center gap-2">
            <span id="status-pill" class="rounded-full border border-slate-700 bg-slate-900 px-3 py-1 text-[11px] font-semibold uppercase tracking-wide text-slate-300">Loading…</span>
            <button id="refresh-btn" type="button" class="inline-flex items-center gap-2 rounded-full border border-blue-700/60 bg-blue-600/90 px-4 py-2 text-xs font-semibold uppercase tracking-wide text-white transition hover:bg-blue-500">
              <i data-lucide="refresh-cw" class="h-4 w-4"></i>
              Refresh
            </button>
          </div>
        </div>
      </section>

      <section class="grid gap-4 md:grid-cols-3">
        <article class="rounded-2xl border border-slate-800 bg-slate-900/70 p-4">
          <p class="text-sm font-semibold text-slate-300">Records</p>
          <p id="total-count" class="text-3xl font-black text-white">0</p>
        </article>
        <article class="rounded-2xl border border-slate-800 bg-slate-900/70 p-4">
          <p class="text-sm font-semibold text-slate-300">Primary key column</p>
          <p id="pk-label" class="text-2xl font-black text-blue-300">—</p>
        </article>
        <article class="rounded-2xl border border-slate-800 bg-slate-900/70 p-4">
          <p class="text-sm font-semibold text-slate-300">Last updated</p>
          <p id="last-sync" class="text-sm font-semibold text-emerald-300">—</p>
        </article>
      </section>

      <section class="space-y-3 rounded-2xl border border-slate-800 bg-slate-900/70 p-4">
        <div class="flex items-center justify-between gap-3">
          <h2 class="text-lg font-bold text-white">Records</h2>
          <button id="add-new-btn" type="button" class="rounded-lg bg-emerald-600 px-4 py-2 text-xs font-semibold uppercase tracking-wide text-white transition hover:bg-emerald-500">Add New</button>
        </div>
        <div class="grid gap-3 rounded-xl border border-slate-800/80 bg-slate-950/50 p-3 md:grid-cols-2 xl:grid-cols-5">
          <label class="grid gap-1 text-[11px] font-semibold uppercase tracking-wide text-slate-300 xl:col-span-2">
            <span>Search</span>
            <input id="search-input" type="text" placeholder="Search across all visible columns…" class="w-full rounded-lg border border-slate-700 bg-slate-900 px-3 py-2 text-xs text-slate-100 focus:border-blue-500 focus:outline-none" />
          </label>
          <label class="grid gap-1 text-[11px] font-semibold uppercase tracking-wide text-slate-300">
            <span>Sort by</span>
            <select id="sort-column" class="w-full rounded-lg border border-slate-700 bg-slate-900 px-3 py-2 text-xs text-slate-100 focus:border-blue-500 focus:outline-none">
              <option value="">No sort</option>
            </select>
          </label>
          <label class="grid gap-1 text-[11px] font-semibold uppercase tracking-wide text-slate-300">
            <span>Order</span>
            <select id="sort-direction" class="w-full rounded-lg border border-slate-700 bg-slate-900 px-3 py-2 text-xs text-slate-100 focus:border-blue-500 focus:outline-none">
              <option value="asc">Ascending</option>
              <option value="desc">Descending</option>
            </select>
          </label>
          <button id="clear-filters-btn" type="button" class="rounded-lg border border-slate-700 px-3 py-2 text-xs font-semibold uppercase tracking-wide text-slate-200 transition hover:bg-slate-800">Clear</button>
          <label class="grid gap-1 text-[11px] font-semibold uppercase tracking-wide text-slate-300">
            <span>Filter column</span>
            <select id="filter-column" class="w-full rounded-lg border border-slate-700 bg-slate-900 px-3 py-2 text-xs text-slate-100 focus:border-blue-500 focus:outline-none">
              <option value="">No filter</option>
            </select>
          </label>
          <label class="grid gap-1 text-[11px] font-semibold uppercase tracking-wide text-slate-300 xl:col-span-2">
            <span>Filter value</span>
            <input id="filter-value" type="text" placeholder="Type a value…" class="w-full rounded-lg border border-slate-700 bg-slate-900 px-3 py-2 text-xs text-slate-100 focus:border-blue-500 focus:outline-none" />
          </label>
        </div>
        <div class="overflow-x-auto">
          <table class="min-w-full divide-y divide-slate-800 text-xs" id="blacklist-table">
            <thead class="bg-slate-950/80 text-slate-300">
              <tr id="table-head-row"></tr>
            </thead>
            <tbody id="table-body" class="divide-y divide-slate-800"></tbody>
          </table>
        </div>
        <p id="feedback" class="min-h-5 text-xs text-slate-300"></p>
      </section>

      <section id="diagnostics-panel" class="hidden space-y-3 rounded-2xl border border-red-800/70 bg-red-950/20 p-4">
        <div class="flex flex-wrap items-center justify-between gap-2">
          <h2 class="text-sm font-bold uppercase tracking-wide text-red-200">Diagnostics</h2>
          <button id="clear-errors-btn" type="button" class="rounded-lg border border-red-700/70 px-3 py-2 text-[11px] font-semibold uppercase tracking-wide text-red-100 transition hover:bg-red-900/30">Clear errors</button>
        </div>
        <p id="diagnostics-summary" class="text-xs text-red-200/90">No runtime errors detected.</p>
        <div class="max-h-72 overflow-auto rounded-xl border border-red-900/70 bg-slate-950/60 p-3">
          <pre id="diagnostics-log" class="whitespace-pre-wrap break-words text-[11px] leading-relaxed text-red-100"></pre>
        </div>
      </section>
    </main>
  </div>

  <div id="row-modal" class="fixed inset-0 z-[60] hidden items-center justify-center bg-slate-950/75 p-4">
    <div class="w-full max-w-2xl rounded-2xl border border-slate-800 bg-slate-900 p-5 shadow-2xl shadow-slate-900/80">
      <div class="mb-4 flex items-center justify-between">
        <h3 id="modal-title" class="text-lg font-bold text-white">New record</h3>
        <button id="modal-close" type="button" class="rounded-md border border-slate-700 px-2 py-1 text-xs text-slate-300 hover:text-white">✕</button>
      </div>
      <form id="row-form" class="grid gap-3"></form>
      <div class="mt-4 flex justify-end gap-2">
        <button id="modal-cancel" type="button" class="rounded-lg border border-slate-700 px-4 py-2 text-xs font-semibold uppercase tracking-wide text-slate-200">Cancel</button>
        <button id="modal-save" type="button" class="rounded-lg bg-emerald-600 px-4 py-2 text-xs font-semibold uppercase tracking-wide text-white">Save</button>
      </div>
    </div>
  </div>

  <script type="module" src="../../assets/scripts/gps-blacklist-admin.js"></script>
  <script type="module" src="../../assets/scripts/sharedHeader.js"></script>
  <script type="module" src="../../assets/scripts/adminNav.js"></script>
</body>
</html>
